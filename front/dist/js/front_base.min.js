function FrontBase(){}function Auth(){self=this,self.mask_wrapper=$(".mask_wrapper"),self.scrollGroup=$(".scroll_group"),self.telephoneInput=$(".signup_group input[name='telephone']"),self.sendSmsBtn=$("#sendSmsBtn")}FrontBase.prototype.run=function(){this.listenAuthBoxHaver()},FrontBase.prototype.listenAuthBoxHaver=function(){var e=$(".auth-box"),s=$(".user-more-box");e.hover(function(){s.show()},function(){s.hide()})},Auth.prototype.showEvent=function(){self=this,self.mask_wrapper.show()},Auth.prototype.hideEvent=function(){self=this,self.mask_wrapper.hide()},Auth.prototype.listenEvent=function(){self=this;var e=$(".signin"),s=$(".signup"),t=$("#close_btn"),n=$(".switch"),o=$(".img_captcha");e.click(function(){self.showEvent(),self.scrollGroup.css({left:0})}),s.click(function(){self.showEvent(),self.scrollGroup.css({left:-400})}),t.click(function(){self.hideEvent()}),n.click(function(){var e=self.scrollGroup.css("left");(e=parseInt(e))<0?self.scrollGroup.animate({left:"0px"}):self.scrollGroup.animate({left:"-400px"})}),o.click(function(){console.log("img is clicked"),o.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.listenRequestEvent=function(){self=this;var e=$(".signin_group"),s=$(".signup_group"),n=e.find("input[name='telephone']"),o=e.find("input[name='password']"),l=e.find("input[name='remember']"),t=e.find(".submit_btn"),i=s.find(".submit_btn"),c=$("#logout_btn");$("body").bind("keyup",function(e){"13"==e.keyCode&&(console.log("login"),t.click())}),t.click(function(){var e=n.val(),s=o.val(),t=l.prop("checked");$.post("/account/login/",{telephone:e,password:s,remember:t?1:0},function(e){if(200==e.code)self.hideEvent(),window.location.reload();else{var s=e.message;if("string"==typeof s||s.constructor==String)window.messageBox.show(s,"info");else for(var t in s){var n=s[t][0];window.messageBox.show(n,"error")}}})}),c.click(function(){$.ajax({url:"account/logout",type:"GET",dataType:"json",data:{},success:function(e){console.log("logout success")}})}),i.click(function(){})},Auth.prototype.SmsSuccessEvent=function(){self=this,messageBox.showSuccess("短信验证码发送成功"),self.sendSmsBtn.addClass("disabled");var e=59;self.sendSmsBtn.unbind("click");var s=setInterval(function(){self.sendSmsBtn.text(e+"s"),(e-=1)<=0&&(clearInterval(s),self.sendSmsBtn.removeClass("disabled"),self.sendSmsBtn.text("发送验证码"),self.listenSmsCaptchaEvent())},1e3)},Auth.prototype.SmsFailEvent=function(e){messageBox.showError(e)},Auth.prototype.listenSmsCaptchaEvent=function(){self=this,self.sendSmsBtn.click(function(){var e=self.telephoneInput.val();e?$.get({url:"account/sms_captcha/",data:{telephone:e},success:function(e){200==e.code?self.SmsSuccessEvent():self.SmsFailEvent(e.message)}}):messageBox.showInfo("请输入手机号码")})},Auth.prototype.run=function(){self=this,self.listenEvent(),self.listenRequestEvent(),self.listenSmsCaptchaEvent()},$(function(){var e=new FrontBase,s=new Auth;e.run(),s.run()});