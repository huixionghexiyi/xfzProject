function Banner(){this.bannerWidth=795,this.bannerGroup=$("#banner_gruop"),this.bannerUl=$("#banner_ul"),this.index=1,this.leftArrow=$("#left_arrow"),this.rightArrow=$("#right_arrow"),this.liList=this.bannerUl.children("li"),this.pageControl=$("#page_control"),this.bannerCount=this.liList.length}function Index(){self=this,self.page=2,self.category_id=0,template.defaults.imports.timeSince=function(e){var n=new Date(e),t=n.getTime(),i=((new Date).getTime()-t)/1e3;if(i<60)return"刚刚";if(60<=i&&i<3600)return(l=parseInt(i/60))+"分钟前";if(3600<=i&&i<86400)return hours=parseInt(i/60/60),hours+"小时前";if(86400<=i&&i<2592e3)return days=parseInt(i/60/60/24),days+"天前";var r=n.getFullYear(),a=n.getMonth(),o=n.getDate(),s=n.getHours(),l=n.getMinutes();return r+"/"+a+"/"+o+" "+s+":"+l}}Banner.prototype.initBanner=function(){var e=this,n=e.liList.eq(0).clone(),t=e.liList.eq(e.bannerCount-1).clone();this.bannerUl.append(n),this.bannerUl.prepend(t),this.bannerUl.css({width:(e.bannerCount+2)*e.bannerWidth,left:-e.bannerWidth})},Banner.prototype.initPageControl=function(){for(var e=$(".page_control"),n=0;n<this.bannerCount;n++){var t=$("<li></li>");e.append(t),0===n&&t.addClass("active")}e.css({width:26*this.bannerCount})},Banner.prototype.toggleArrow=function(e){e?(this.leftArrow.show(),this.rightArrow.show()):(this.leftArrow.hide(),this.rightArrow.hide())},Banner.prototype.animate=function(){var e=this;this.bannerUl.animate({left:-e.bannerWidth*e.index},500);var n=e.index;n=0===n?e.bannerCount-1:n===e.bannerCount+1?0:e.index-1,e.pageControl.children("li").eq(n).addClass("active").siblings().removeClass("active")},Banner.prototype.loop=function(){var e=this;e.timer=setInterval(function(){e.index>=e.bannerCount+1?(e.bannerUl.css({left:-e.bannerWidth}),e.index=2):e.index++,e.animate()},2e3)},Banner.prototype.listenPageCotrol=function(){var t=this;t.pageControl.children("li").each(function(e,n){$(n).click(function(){t.index=e,t.animate(),$(n).addClass("active").siblings().removeClass("active")})})},Banner.prototype.listenBannerHover=function(){var e=this;e.bannerGroup.hover(function(){clearInterval(e.timer),e.toggleArrow(!0)},function(){e.loop(),e.toggleArrow(!1)})},Banner.prototype.listenArrowClick=function(){var e=this;e.leftArrow.click(function(){0===e.index?(e.bannerUl.css({left:-e.bannerWidth*e.bannerCount}),e.index=e.bannerCount-1):e.index--,e.animate()}),e.rightArrow.click(function(){e.index===e.bannerCount+1?(e.bannerUl.css({left:-e.bannerWidth}),e.index=2):e.index++,e.animate()})},Banner.prototype.run=function(){this.loop(),this.listenArrowClick(),this.listenBannerHover(),this.initPageControl(),this.initBanner(),this.listenPageCotrol()},Index.prototype.listenMoreNewsEvent=function(){self=this,moreNewsBtn=$("#load-more-btn"),moreNewsBtn.click(function(){$.get({url:"/news/list/",data:{p:self.page,category_id:self.category_id},success:function(e){if(200===e.code){var n=e.data;if(0<n.length){var t=template("news-item",{newses:n});$(".list_inner_group").append(t),self.page+=1}else moreNewsBtn.hide()}}})})},Index.prototype.listenCategorySwitchEnvet=function(){self=this;var e=$(".list_tab"),a=$(".list_inner_group");moreNewsBtn=$("#load-more-btn"),e.children().click(function(){var i=$(this),r=i.attr("date-category");$.get({url:"/news/list/",data:{category_id:r},dataType:"json",success:function(e){if(200===e.code){var n=e.data,t=template("news-item",{newses:n});a.empty(),a.append(t),i.addClass("active").siblings().removeClass("active"),self.category_id=r,self.page=2,moreNewsBtn.show()}}})})},Index.prototype.run=function(){self=this,self.listenMoreNewsEvent(),self.listenCategorySwitchEnvet()},$(function(){var e=new Banner;(new Index).run(),e.run()});